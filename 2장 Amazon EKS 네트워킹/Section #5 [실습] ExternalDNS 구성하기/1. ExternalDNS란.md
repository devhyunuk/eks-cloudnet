# 1. ExternalDNS란
1) 자신만의 퍼블릭 도메인으로 해당 서비스의 연결을 확인하는 작업까지 진행
2) 퍼블릭 도메인을 사용해 Kubernetes에 구성된 자원을 쿼리할 수 있도록 도메인을 관리하는 오픈소스 솔루션
3) 다양한 퍼블릭 도메인 공급자와 연계해서 호스팅 영역의 레코드를 관리할 수 있음
4) 실습에는 AWS Route 53과 연계해서 작업을 수행
   - 자신만의 도메인 주소를 보유해야 하고 해당 도메인을 AWS Route 53에서 관리하는 환경이 구성 필요
   -  도메인 구매와 AWS Route 53에서 호스팅 영역의 관리에 따라 과금 발생
     
## 3.1. ExternalDNS 아키텍처

![image](https://github.com/devhyunuk/eks-cloudnet/assets/49749510/1d34e7a4-eab7-4e18-9481-8de361148ba8)

1) ingress와 service의 LoadBalancer로 클러스터 내부의 파드들을 외부에서 노출하는 환경
2) 클라이언트는 ALB 또는 NLB 로드밸런스의 도메인 주소를 통해 접근을 수행
   - 로드밸런스의 주소는 AWS 관리 하에 동적으로 도메인 주소가 생성
   - 그런데 통신을 위한 도메인 주소는 굉장히 길고 복잡함.
  
3) ALB, NLB의 도메인 복잡함을 해소하고 도메인 주소 관리의 용의를 위해 ExternalDNS를 구성하여 자신만의 도메인과 연결할 수 있음
4) ExternalDNS는 Pod 형태로 구성되어 자신의 퍼블릿 도메인 호스팅 영역과 연결 가능
    - ExternalDNS에서 Route 53 호스팅 영역에 레코드를 추가하거나 삭제하는 작업 가능
    - 이때 AWS LoadBalancer Controller와 비슷한 개념으로 AWS 자원을 관리하기 위한 권한이 필요
    - 권한 위임을 위한 다양한 방법이 있지만 Node의 IAM 역할을 통해 수행 가능
    - eksctl의 명령으로 클러스터를 생성할 때 ExternalDNS 액세스 옵션을 부여하면 자동으로 생성 가능 (수동으로 IAM 관련 작업도 가능)
    - ExternalDNS의 권한이 Route 53으로 레코드 추가나 삭제 등의 작업을 수행 가능
  
5) 4번의 방법으로 복잡한 구조의 ALB, NLB의 도메인 주소를 간략하게 자신만의 도메인 주소로 레코드를 구성 가능
   -  클라이언트에 접근하는 주소는 익스터널 DNS를 통해 정의된 도메인 주소로 통신할 수 있음


















